[build]
  command = "npm run build"
  publish = "dist"
  edge_functions = "netlify/edge-functions"

[build.environment]
  NODE_VERSION = "20"
  # Vite exposes VITE_* vars to browser bundles by design.
  # Supabase URL + anon key are public client values (RLS must protect data).
  SECRETS_SCAN_OMIT_KEYS = "VITE_GOOGLE_MAPS_API_KEY,VITE_GEMINI_API_KEY,VITE_SUPABASE_URL,VITE_SUPABASE_ANON_KEY"

[dev]
  targetPort = 5173

[[edge_functions]]
  path = "/api/og/trip"
  function = "trip-og-image"

[[edge_functions]]
  path = "/api/og/playground"
  function = "trip-og-playground"

[[edge_functions]]
  path = "/s/*"
  function = "trip-og-meta"

[[edge_functions]]
  path = "/trip/*"
  function = "trip-og-meta"

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
